{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _toConsumableArray from \"/home/runner/work/mapa-vacinacao-c19/mapa-vacinacao-c19/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"/home/runner/work/mapa-vacinacao-c19/mapa-vacinacao-c19/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useEffect, useRef, useState } from 'react';\nimport { Line } from 'react-chartjs-2';\nimport { lineChartCommon, lineChartCommon2, RESIZE_TRESHOLD } from '../../constants';\nimport { hexToRgb } from '../../utils';\nimport { Card } from './../Card';\nimport classNames from 'classnames';\nimport styles from './../Card.module.scss';\nimport { useCanvasResizer } from '../../hooks/useCanvasResizer';\nexport function LineRt(_ref) {\n  var statistics = _ref.statistics,\n      colors = _ref.colors,\n      regiao = _ref.regiao;\n\n  var _useState = useState(false),\n      loaded = _useState[0],\n      setLoaded = _useState[1];\n\n  var _useCanvasResizer = useCanvasResizer(),\n      setCanvasNode = _useCanvasResizer.setCanvasNode;\n\n  var main = colors.main;\n\n  var _useState2 = useState(regiao !== null && regiao !== void 0 ? regiao : 'continente'),\n      currentRegiao = _useState2[0],\n      setCurrentRegiao = _useState2[1];\n\n  var _useState3 = useState({}),\n      rtData = _useState3[0],\n      setRtData = _useState3[1];\n\n  var canvasRef = useRef(null);\n  useEffect(function () {\n    console.log('set regioao');\n    if (!loaded) return;\n    statistics.getRtRegiao(currentRegiao).then(function (data) {\n      return setRtData(data);\n    });\n  }, [currentRegiao]);\n  useEffect(function () {\n    statistics.getRtRegiao(currentRegiao).then(function (data) {\n      setRtData(data);\n      setLoaded(true);\n    });\n  }, []);\n\n  var data = function data(canvas) {\n    var ctx = canvas === null || canvas === void 0 ? void 0 : canvas.getContext('2d');\n    var gradient = ctx === null || ctx === void 0 ? void 0 : ctx.createLinearGradient(0, 0, 0, 400);\n    var color = '';\n\n    var _hexToRgb = hexToRgb(main),\n        r = _hexToRgb.r,\n        g = _hexToRgb.g,\n        b = _hexToRgb.b;\n\n    try {\n      //See if supports transperancy\n      gradient.addColorStop(0, 'rgba(' + r + ',' + g + ',' + b + ',30%)');\n      color = 'rgba(' + r + ',' + g + ',' + b + ',30%)';\n    } catch (e) {\n      gradient.addColorStop(0, '#d9f3ef');\n      color = '#d9f3ef';\n    }\n\n    setCanvasNode(canvas.parentNode);\n    return {\n      labels: rtData.labels,\n      datasets: [_objectSpread(_objectSpread({}, lineChartCommon2), {}, {\n        label: 'R(t) limite superior',\n        backgroundColor: color,\n        borderColor: 'transparent',\n        type: 'line',\n        fill: '2',\n        //fill until previous dataset\n        data: rtData.rt.map(function (el) {\n          return el.limite_superior_IC95.toFixed(2);\n        }),\n        order: 1\n      }), _objectSpread(_objectSpread({}, lineChartCommon), {}, {\n        label: 'R(t)',\n        backgroundColor: main,\n        borderColor: main,\n        type: 'line',\n        fill: false,\n        data: rtData.rt.map(function (el) {\n          return el.rt_numero_de_reproducao.toFixed(2);\n        }),\n        order: 2\n      }), _objectSpread(_objectSpread({}, lineChartCommon2), {}, {\n        label: 'R(t) limite inferior',\n        backgroundColor: 'white',\n        borderColor: 'transparent',\n        type: 'line',\n        fill: false,\n        data: rtData.rt.map(function (el) {\n          return el.limite_inferior_IC95.toFixed(2);\n        }),\n        order: 3\n      })\n      /* \t{\n      \t...lineChartCommon,\n      \tfill: false,\n      \tborderColor: complements[1],\n      \tlabel: 'Casos Confirmados',\n      \tbackgroundColor: complements[1],\n      \tpointBorderColor: complements[1],\n      \tpointBackgroundColor: complements[1],\n      \tpointHoverBackgroundColor: complements[1],\n      \tpointHoverBorderColor: complements[1],\n      \tdata: casesData.filter((el) => el.Data >= 1609070400000).map((el) => el.confirmados_novos),\n      \torder: 4,\n      }, */\n\n      /* {\n      \t...lineChartCommon,\n      \tfill: false,\n      \tborderColor: complements[2],\n      \tlabel: 'Totalmente inoculados',\n      \tbackgroundColor: complements[2],\n      \tpointBorderColor: complements[2],\n      \tpointBackgroundColor: complements[2],\n      \tpointHoverBackgroundColor: complements[2],\n      \tpointHoverBorderColor: complements[2],\n      \tdata: valuesIn2,\n      \torder: -1,\n      }, */\n      ]\n    };\n  };\n\n  var options = function options() {\n    var max = parseInt(Math.max.apply(Math, _toConsumableArray(rtData.rt.map(function (el) {\n      return el.limite_superior_IC95.toFixed(2);\n    }))) + 1);\n    return {\n      plugins: {\n        datalabels: {\n          display: false\n        },\n        legend: {\n          position: 'bottom',\n          align: 'start',\n          labels: {\n            filter: function filter(item, chart) {\n              return !item.text.match('limite');\n            }\n          }\n        },\n        annotation: {\n          annotations: [{\n            type: 'line',\n            mode: 'horizontal',\n            scaleID: 'y',\n            value: 1,\n            borderColor: '#0A9DD1',\n            borderWidth: 2,\n            borderDash: [5, 5],\n            label: {\n              backgroundColor: 'rgba(0,0,0,0.0)',\n              drawTime: 'beforeDatasetsDraw',\n              font: {\n                style: 'normal'\n              },\n              textAlign: 'left',\n              color: '#0A9DD1',\n              position: 'end',\n              xAdjust: 10,\n              yAdjust: -10,\n              enabled: true,\n              content: 'R(t) = 1'\n            }\n          }]\n        }\n      },\n      animation: {\n        duration: 1000\n      },\n      tooltips: {\n        mode: 'index',\n        intersect: true,\n        callbacks: {\n          title: function title(tooltipItem, data) {\n            return 'Dia ' + tooltipItem[0].label;\n          }\n        }\n      },\n      scales: {\n        y: {\n          type: 'linear',\n          ticks: {\n            beginAtZero: true,\n            maxTicksLimit: window.innerWidth <= RESIZE_TRESHOLD ? 8 : 10,\n            minTicksLimit: window.innerWidth <= RESIZE_TRESHOLD ? 8 : 10,\n            stepSize: max / 4\n          },\n          min: 0,\n          max: max\n        },\n        x: {\n          ticks: {\n            maxTicksLimit: 30,\n            minTicksLimit: 30\n          }\n        }\n      }\n    };\n  };\n\n  return /*#__PURE__*/_jsxs(Card, {\n    textLeft: true,\n    allowOverflow: true,\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: [styles.card_dynamic_scroll].join(' '),\n      children: regiao === undefined ? /*#__PURE__*/_jsx(\"div\", {\n        className: 'toggle_buttons',\n        children: /*#__PURE__*/_jsxs(\"p\", {\n          children: [/*#__PURE__*/_jsx(\"button\", {\n            className: classNames('toggle_button', {\n              active: currentRegiao === 'continente'\n            }),\n            onClick: function onClick() {\n              setCurrentRegiao('continente');\n            },\n            children: \"Continente\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: classNames('toggle_button', {\n              active: currentRegiao === 'nacional'\n            }),\n            onClick: function onClick() {\n              setCurrentRegiao('nacional');\n            },\n            children: \"Nacional\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: classNames('toggle_button', {\n              active: currentRegiao === 'lvt'\n            }),\n            onClick: function onClick() {\n              setCurrentRegiao('lvt');\n            },\n            children: \"Lisboa e Vale do Tejo\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: classNames('toggle_button', {\n              active: currentRegiao === 'algarve'\n            }),\n            onClick: function onClick() {\n              setCurrentRegiao('algarve');\n            },\n            children: \"Algarve\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: classNames('toggle_button', {\n              active: currentRegiao === 'alentejo'\n            }),\n            onClick: function onClick() {\n              setCurrentRegiao('alentejo');\n            },\n            children: \"Alentejo\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: classNames('toggle_button', {\n              active: currentRegiao === 'centro'\n            }),\n            onClick: function onClick() {\n              setCurrentRegiao('centro');\n            },\n            children: \"Centro\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: classNames('toggle_button', {\n              active: currentRegiao === 'norte'\n            }),\n            onClick: function onClick() {\n              setCurrentRegiao('norte');\n            },\n            children: \"Norte\"\n          })]\n        })\n      }) : /*#__PURE__*/_jsx(_Fragment, {})\n    }), /*#__PURE__*/_jsx(\"div\", {\n      children: loaded ? /*#__PURE__*/_jsx(Line, {\n        height: 80,\n        ref: canvasRef,\n        options: options(),\n        data: data\n      }) : ''\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}