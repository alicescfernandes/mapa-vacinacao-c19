{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _defineProperty from \"/home/runner/work/mapa-vacinacao-c19/mapa-vacinacao-c19/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/home/runner/work/mapa-vacinacao-c19/mapa-vacinacao-c19/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useContext, useEffect, useRef, useState } from 'react';\nimport { Bar } from 'react-chartjs-2';\nimport { REGIOES, RESIZE_TRESHOLD } from '../../constants';\nimport { formatNumber, makeAnnotations } from '../../utils';\nimport { Card } from './../Card';\nimport acontecimentos from './../../data/acontecimentos.json';\nimport { RegiaoContext } from '../context/regiao';\nimport { CustomCheckbox } from './../CustomCheckbox';\nimport styles from './../Card.module.scss';\nexport function VacinadosPorDia(_ref) {\n  var statistics = _ref.statistics,\n      colors = _ref.colors;\n  var regiao = useContext(RegiaoContext);\n\n  var _useState = useState(true),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var _statistics$getDiario = statistics.getDiariosInoculacoes(),\n      values = _statistics$getDiario.values,\n      labels = _statistics$getDiario.labels,\n      valuesIn1 = _statistics$getDiario.valuesIn1,\n      valuesIn2 = _statistics$getDiario.valuesIn2;\n\n  var _statistics$getMediaM = statistics.getMediaMovelDiaria(7),\n      values2 = _statistics$getMediaM.values;\n\n  var _useState2 = useState([]),\n      vacinas_stock = _useState2[0],\n      setVacinas_stock = _useState2[1];\n\n  var main = colors.main,\n      tints = colors.tints,\n      shades = colors.shades,\n      complements = colors.complements;\n\n  var _useState3 = useState({\n    stock: true\n  }),\n      toggleStats = _useState3[0],\n      setToggleStats = _useState3[1];\n\n  var canvasRef = useRef(null);\n\n  var data = function data(canvas) {\n    if (window.innerWidth <= RESIZE_TRESHOLD) {\n      canvas.parentNode.style.width = RESIZE_TRESHOLD + 'px';\n    } else {\n      canvas.parentNode.style.width = '100%';\n    }\n\n    window.addEventListener('resize', function () {\n      if (window.innerWidth <= RESIZE_TRESHOLD) {\n        canvas.parentNode.style.width = RESIZE_TRESHOLD + 'px';\n      } else {\n        canvas.parentNode.style.width = '100%';\n      }\n    });\n    var datasets = [{\n      label: 'Vacinas diárias - Média movel de 7 dias',\n      fill: false,\n      lineTension: 0.5,\n      overlayBars: true,\n      type: 'line',\n      lineBorder: 1,\n      borderWidth: 3,\n      borderColor: complements[1],\n      borderJoinStyle: 'miter',\n      pointBorderColor: complements[1],\n      pointBackgroundColor: complements[1],\n      pointBorderWidth: 1,\n      pointHoverRadius: 3,\n      pointHoverBorderWidth: 2,\n      pointRadius: 1,\n      pointHitRadius: 3,\n      data: values2,\n      order: 2,\n      stack: 'stack1'\n    }, {\n      label: 'Inoculação - 2ª Dose',\n      fill: false,\n      type: 'bar',\n      overlayBars: true,\n      backgroundColor: tints[0],\n      data: valuesIn2,\n      order: 3,\n      display: false,\n      stack: 'stack0'\n    }, {\n      label: 'Inoculação - 1ª Dose',\n      backgroundColor: shades[0],\n      borderColor: shades[0],\n      data: valuesIn1,\n      overlayBars: true,\n      order: 4,\n      stack: 'stack0'\n    }, {\n      label: 'Vacinas Totais',\n      type: 'bar',\n      overlayBars: true,\n      fill: false,\n      borderColor: main,\n      backgroundColor: 'transparent',\n      data: values,\n      borderWidth: 2,\n      order: 5,\n      stack: 'stack0',\n      yAxisID: 'axisy2'\n    }];\n\n    if (regiao === REGIOES.PORTUGAL) {\n      datasets.push({\n        label: 'Stock de Vacinas - Estimativa',\n        fill: false,\n        lineTension: 0.5,\n        overlayBars: true,\n        type: 'line',\n        lineBorder: 1,\n        borderWidth: 3,\n        borderColor: complements[2],\n        borderJoinStyle: 'miter',\n        pointBorderColor: complements[2],\n        pointBackgroundColor: complements[2],\n        pointBorderWidth: 1,\n        pointHoverRadius: 3,\n        pointHoverBorderWidth: 2,\n        pointRadius: 1,\n        pointHitRadius: 3,\n        data: vacinas_stock,\n        order: 6,\n        hidden: !toggleStats.stock,\n        stack: 'stack2'\n      });\n    }\n\n    return {\n      labels: labels,\n      datasets: datasets\n    };\n  };\n\n  var numberFormatter = new Intl.NumberFormat();\n  var horizontalAnnotations = makeAnnotations(acontecimentos);\n  var annotations = {\n    annotations: _toConsumableArray(horizontalAnnotations)\n  };\n\n  var options = function options() {\n    var max = Math.max.apply(Math, _toConsumableArray(toggleStats.stock === true ? vacinas_stock : values));\n    return {\n      layout: {\n        padding: -5\n      },\n      plugins: {\n        datalabels: {\n          display: false,\n          color: 'blue'\n        },\n        annotation: regiao == 'portugal' ? annotations : {},\n        legend: {\n          position: 'bottom',\n          align: 'start'\n        }\n      },\n      animation: {\n        duration: 1000\n      },\n      tooltips: {\n        mode: 'index',\n        intersect: false,\n        callbacks: {\n          label: function label(tooltipItem, data) {\n            var label = data.datasets[tooltipItem.datasetIndex].label;\n            return label + ': ' + numberFormatter.format(parseInt(tooltipItem.value)).replace(',', ' ');\n          },\n          title: function title(tooltipItem, data) {\n            return 'Dia ' + tooltipItem[0].label;\n          }\n        }\n      },\n      scales: {\n        y: {\n          stacked: true,\n          display: true,\n          ticks: {\n            beginAtZero: true,\n            maxTicksLimit: window.innerWidth <= RESIZE_TRESHOLD ? 8 : 10,\n            minTicksLimit: window.innerWidth <= RESIZE_TRESHOLD ? 8 : 10,\n            callback: function callback(value, index, values) {\n              return formatNumber(value, false);\n            }\n          },\n          suggestedMax: max\n        },\n        axisy2: {\n          display: false,\n          ticks: {\n            beginAtZero: true,\n            maxTicksLimit: window.innerWidth <= RESIZE_TRESHOLD ? 8 : 10,\n            minTicksLimit: window.innerWidth <= RESIZE_TRESHOLD ? 8 : 10,\n            callback: function callback(value, index, values) {\n              return formatNumber(value, false);\n            }\n          },\n          suggestedMax: max\n        },\n        x: {\n          ticks: {\n            beginAtZero: true,\n            maxTicksLimit: window.innerWidth <= RESIZE_TRESHOLD ? 30 : 60,\n            minTicksLimit: window.innerWidth <= RESIZE_TRESHOLD ? 30 : 60\n          }\n        }\n      }\n    };\n  };\n\n  useEffect(function () {\n    if (values.length && loading === true) {\n      statistics.getEstimativaStock().then(function (_ref2) {\n        var vaccines_stock_var = _ref2.vaccines_stock_var;\n        setVacinas_stock(vaccines_stock_var);\n        setLoading(false);\n      });\n    }\n  }, [values]);\n  return /*#__PURE__*/_jsxs(Card, {\n    allowOverflow: true,\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: [styles.card_checkboxes, styles.card_scrollable].join(' '),\n      style: {\n        textAlign: 'left'\n      },\n      children: /*#__PURE__*/_jsx(CustomCheckbox, {\n        checked: toggleStats.stock,\n        label: 'Stock de Vacinas - Estimativa',\n        onChange: function onChange(checked) {\n          setToggleStats(_objectSpread(_objectSpread({}, toggleStats), {}, {\n            stock: checked\n          }));\n        }\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      children: !loading ? /*#__PURE__*/_jsx(Bar, {\n        height: 80,\n        ref: canvasRef,\n        options: options(),\n        data: data\n      }) : ''\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}