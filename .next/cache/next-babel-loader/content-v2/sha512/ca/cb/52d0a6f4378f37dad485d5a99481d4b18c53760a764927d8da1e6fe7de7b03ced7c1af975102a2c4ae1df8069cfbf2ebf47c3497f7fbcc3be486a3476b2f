{"ast":null,"code":"const url = 'https://raw.githubusercontent.com/dssg-pt/covid19pt-data/master/vacinas_detalhe.csv';\n\nvar csv = require('csvtojson');\n\nimport Cors from 'cors';\nimport { trackPlausible } from '../../utils';\n\nfunction initMiddleware(middleware) {\n  return (req, res) => new Promise((resolve, reject) => {\n    middleware(req, res, result => {\n      if (result instanceof Error) {\n        return reject(result);\n      }\n\n      return resolve(result);\n    });\n  });\n}\n\nconst cors = initMiddleware(Cors({\n  methods: ['GET']\n}));\nexport default async function handler(req, res) {\n  trackPlausible(req);\n  await cors(req, res);\n  res.statusCode = 200;\n  let contents = await fetch(url).then(res => res.buffer());\n  csv().fromString(contents.toString()).then(function (jsonArrayObj) {\n    res.json(jsonArrayObj);\n  });\n}","map":null,"metadata":{},"sourceType":"module"}